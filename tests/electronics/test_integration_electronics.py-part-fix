    # Mock backend to return high tension
    def mock_get_tendon_tension(wire_id):
        if wire_id == "wire_torn_test":
            return 1000.0  # Way over limit for AWG24
        return 0.0

    monkeypatch.setattr(loop.backend, "get_tendon_tension", mock_get_tendon_tension)

    metrics = loop.step(control_inputs={}, duration=0.01)

    assert metrics.success is False
    assert "wire_torn:wire_torn_test" in metrics.fail_reason


def test_int_120_circuit_validation_pre_gate(monkeypatch):
